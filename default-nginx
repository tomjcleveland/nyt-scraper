# Default server configuration
# Proxy to NY Times' GraphQL endpoint
server {
	listen 80 default_server;
	listen [::]:80 default_server;


	root /var/www/html;

	index index.html index.htm index.nginx-debian.html;

	server_name _;

	location / {
		proxy_pass https://samizdat-graphql.nytimes.com/;
		add_header Access-Control-Allow-Origin $http_origin always;
		add_header access-control-allow-credentials true always;
		add_header access-control-allow-headers nyt-app-version,nyt-app-type,nyt-token,content-type,referer,user-agent always;
	}

}

# Serving the GraphiQL explorer
server {
    listen                81;
    server_name           _;
    auth_basic            "Protected";
    auth_basic_user_file  /etc/apache2/.htpasswd;
    root                  /home/ubuntu/nyt-scraper/graphiql-nyt/build;
}
